<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ùêÜùêéùêÉùêíùêñùêàùêãùêãùêÖùêãùêÄùêíùêáùêíùêÇùêéùêëùêÑ - Sports Predictions</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            color: #fff;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 0;
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            margin-bottom: 30px;
        }

        header h1 {
            font-size: 2.5em;
            letter-spacing: 2px;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.5);
        }

        .user-info {
            text-align: right;
            margin-bottom: 20px;
        }

        .logout-btn {
            background: rgba(255,0,0,0.6);
            padding: 8px 20px;
            border: none;
            border-radius: 20px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: rgba(255,0,0,0.8);
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 25px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            color: #fff;
            cursor: pointer;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: #00d4ff;
            border-color: #00d4ff;
            color: #000;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .prediction-card {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s;
            position: relative;
        }

        .prediction-card:hover {
            background: rgba(255,255,255,0.15);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .teams {
            font-size: 1.3em;
            font-weight: bold;
        }

        .prediction {
            background: #00d4ff;
            color: #000;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        .confidence {
            background: rgba(0,212,255,0.2);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-item {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 8px;
        }

        .stat-label {
            font-size: 0.9em;
            color: #00d4ff;
            margin-bottom: 5px;
        }

        .locked-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.85);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .lock-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .upgrade-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: #fff;
            padding: 15px 40px;
            border: none;
            border-radius: 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s;
        }

        .upgrade-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(245, 87, 108, 0.5);
        }

        .auth-container {
            max-width: 450px;
            margin: 50px auto;
            background: rgba(255,255,255,0.1);
            padding: 40px;
            border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .auth-container h2 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2em;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: #fff;
            font-size: 16px;
        }

        .input-group input::placeholder {
            color: rgba(255,255,255,0.5);
        }

        .btn-primary {
            width: 100%;
            padding: 15px;
            background: #00d4ff;
            color: #000;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            background: #00b8e6;
            transform: translateY(-2px);
        }

        .switch-auth {
            text-align: center;
            margin-top: 20px;
        }

        .switch-auth a {
            color: #00d4ff;
            cursor: pointer;
            text-decoration: underline;
        }

        .developer-credit {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.2);
            font-size: 14px;
            line-height: 1.8;
        }

        .developer-credit a {
            color: #00d4ff;
            text-decoration: none;
        }

        .developer-credit a:hover {
            text-decoration: underline;
        }

        .admin-menu {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 30px;
            height: 30px;
            cursor: pointer;
            z-index: 1000;
            opacity: 0.2;
            transition: opacity 0.3s;
        }

        .admin-menu:hover {
            opacity: 1;
        }

        .hamburger {
            width: 25px;
            height: 3px;
            background: #fff;
            margin: 5px 0;
            border-radius: 2px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            padding: 40px;
            border-radius: 15px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            border: 2px solid rgba(255,255,255,0.3);
            margin: 20px;
        }

        .close-modal {
            float: right;
            font-size: 30px;
            cursor: pointer;
            color: #fff;
            line-height: 1;
        }

        .close-modal:hover {
            color: #ff0000;
        }

        .payment-info {
            background: rgba(0,212,255,0.1);
            border: 2px solid #00d4ff;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .payment-info h3 {
            color: #00d4ff;
            margin-bottom: 15px;
        }

        .payment-detail {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 10px;
            background: rgba(0,0,0,0.3);
            border-radius: 5px;
        }

        .payment-detail strong {
            color: #00d4ff;
        }

        .important-note {
            background: rgba(245, 87, 108, 0.2);
            border: 2px solid #f5576c;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .admin-panel {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .user-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .user-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .user-info-detail {
            flex: 1;
        }

        .user-actions {
            display: flex;
            gap: 10px;
        }

        .badge {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .badge-premium {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .badge-free {
            background: rgba(255,255,255,0.2);
        }

        .btn-small {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .btn-activate {
            background: #00d4ff;
            color: #000;
        }

        .btn-remove {
            background: #ff4444;
            color: #fff;
        }

        .btn-small:hover {
            transform: scale(1.05);
        }

        .search-box {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: #fff;
            font-size: 16px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2em;
        }

        .spinner {
            border: 4px solid rgba(255,255,255,0.1);
            border-top: 4px solid #00d4ff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-msg {
            background: rgba(255,0,0,0.2);
            border: 1px solid #ff0000;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }

        .success-msg {
            background: rgba(0,255,0,0.2);
            border: 1px solid #00ff00;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            .teams {
                font-size: 1.1em;
            }

            .modal-content {
                padding: 20px;
            }

            .user-item {
                flex-direction: column;
                align-items: flex-start;
            }

            .user-actions {
                width: 100%;
                justify-content: flex-start;
            }
        }
    </style>
</head>
<body>

    <!-- Admin Menu (Hidden) -->
    <div class="admin-menu" onclick="showAdminLogin()">
        <div class="hamburger"></div>
        <div class="hamburger"></div>
        <div class="hamburger"></div>
    </div>

    <!-- Auth Container -->
    <div id="authContainer" class="auth-container">
        <h2>ùêÜùêéùêÉùêíùêñùêàùêãùêãùêÖùêãùêÄùêíùêáùêíùêÇùêéùêëùêÑ</h2>
        
        <!-- Login Form -->
        <div id="loginForm">
            <div class="input-group">
                <label>Email</label>
                <input type="email" id="loginEmail" placeholder="Enter your email">
            </div>
            <div class="input-group">
                <label>Password</label>
                <input type="password" id="loginPassword" placeholder="Enter your password">
            </div>
            <button class="btn-primary" onclick="login()">Login</button>
            <div class="switch-auth">
                Don't have an account? <a onclick="switchToSignup()">Sign Up</a>
            </div>
        </div>

        <!-- Signup Form -->
        <div id="signupForm" style="display: none;">
            <div class="input-group">
                <label>Username</label>
                <input type="text" id="signupUsername" placeholder="Choose a username">
            </div>
            <div class="input-group">
                <label>Email</label>
                <input type="email" id="signupEmail" placeholder="Enter your email">
            </div>
            <div class="input-group">
                <label>Password</label>
                <input type="password" id="signupPassword" placeholder="Create a password (min 6 characters)">
            </div>
            <button class="btn-primary" onclick="signup()">Sign Up</button>
            <div class="switch-auth">
                Already have an account? <a onclick="switchToLogin()">Login</a>
            </div>
        </div>

        <div class="developer-credit">
            <strong>Created by "·¥Ö·¥á·¥†…¢·¥è·¥ÖÍú±·¥°…™ ü ü"</strong><br><br>
            <strong>Contact Developer:</strong><br>
            üìß Email: <a href="mailto:Ihechigodswill575@gmail.com">Ihechigodswill575@gmail.com</a><br>
            üëª Snapchat: <strong>KIZOELITE_2</strong>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="appContainer" class="container" style="display: none;">
        <header>
            <h1>ùêÜùêéùêÉùêíùêñùêàùêãùêãùêÖùêãùêÄùêíùêáùêíùêÇùêéùêëùêÑ</h1>
        </header>

        <div class="user-info">
            <span>Welcome, <strong id="currentUsername"></strong></span>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>

        <div class="nav-tabs">
            <button class="tab-btn active" onclick="showTab('predictions')">Today's Predictions</button>
            <button class="tab-btn" onclick="showTab('analysis')">üîí Detailed Analysis</button>
            <button class="tab-btn" onclick="showTab('history')">üîí History & Stats</button>
            <button class="tab-btn" onclick="showTab('upgrade')">‚≠ê Upgrade to Premium</button>
        </div>

        <!-- Predictions Tab -->
        <div id="predictions" class="tab-content active">
            <div id="predictionsLoading" class="loading">
                <div class="spinner"></div>
                Loading today's predictions...
            </div>
            <div id="predictionsList"></div>
        </div>

        <!-- Analysis Tab (Premium) -->
        <div id="analysis" class="tab-content">
            <div class="prediction-card">
                <h2>Detailed Match Analysis</h2>
                <div class="locked-overlay">
                    <div class="lock-icon">üîí</div>
                    <h3>Premium Feature</h3>
                    <p>Unlock detailed statistical analysis, confidence scores, and expert insights for all matches.</p>
                    <button class="upgrade-btn" onclick="showTab('upgrade')">Upgrade to Premium</button>
                </div>
            </div>
        </div>

        <!-- History Tab (Premium) -->
        <div id="history" class="tab-content">
            <div class="prediction-card">
                <h2>Prediction History & Accuracy</h2>
                <div class="locked-overlay">
                    <div class="lock-icon">üîí</div>
                    <h3>Premium Feature</h3>
                    <p>View our complete prediction history, success rates, and performance statistics.</p>
                    <button class="upgrade-btn" onclick="showTab('upgrade')">Upgrade to Premium</button>
                </div>
            </div>
        </div>

        <!-- Upgrade Tab -->
        <div id="upgrade" class="tab-content">
            <div class="prediction-card">
                <h2>‚≠ê Upgrade to Premium</h2>
                <h3 style="color: #00d4ff; margin: 20px 0;">‚Ç¶5,000/month</h3>
                
                <div style="margin: 30px 0;">
                    <h3>Premium Features Include:</h3>
                    <ul style="margin: 20px 0; line-height: 2;">
                        <li>‚úÖ Unlimited daily predictions (10-20+ matches)</li>
                        <li>‚úÖ Detailed statistical analysis for every match</li>
                        <li>‚úÖ Confidence scores and reasoning</li>
                        <li>‚úÖ Historical accuracy tracking</li>
                        <li>‚úÖ Multiple leagues coverage</li>
                        <li>‚úÖ Early access to predictions</li>
                        <li>‚úÖ Email notifications</li>
                        <li>‚úÖ Betting tips and stake recommendations</li>
                    </ul>
                </div>

                <button class="upgrade-btn" onclick="showPaymentModal()">Proceed to Payment</button>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closePaymentModal()">&times;</span>
            <h2>Upgrade to Premium</h2>
            
            <div class="payment-info">
                <h3>Payment Instructions</h3>
                <p><strong>Step 1:</strong> Transfer ‚Ç¶5,000 to:</p>
                <div class="payment-detail">
                    <span><strong>Bank:</strong></span>
                    <span>PalmPay</span>
                </div>
                <div class="payment-detail">
                    <span><strong>Account Number:</strong></span>
                    <span>8145688688</span>
                </div>
                <div class="payment-detail">
                    <span><strong>Account Name:</strong></span>
                    <span>OGECHI CHINONSO OKONKWO</span>
                </div>
            </div>

            <div class="important-note">
                <strong>‚ö†Ô∏è VERY IMPORTANT - Step 2:</strong><br>
                When making the transfer, you MUST write your username in the <strong>Note</strong> field before completing payment.<br><br>
                <strong>Example:</strong> If your username is "OGECHI", write "OGECHI" in the Note field.
            </div>

            <p><strong>Step 3:</strong> After successful payment, enter your username below and click Submit.</p>

            <div class="input-group" style="margin-top: 20px;">
                <label>Your Username:</label>
                <input type="text" id="paymentUsername" placeholder="Enter your username">
            </div>

            <button class="btn-primary" onclick="submitPaymentRequest()">Submit Payment Request</button>

            <p style="margin-top: 20px; font-size: 0.9em; color: #00d4ff;">
                <strong>Note:</strong> Your premium access will be activated within 24 hours after payment verification. Make sure the username you enter matches exactly what you wrote in the transfer note.
            </p>

            <div style="margin-top: 20px; padding: 15px; background: rgba(0,212,255,0.1); border-radius: 8px;">
                <strong>Why do I need to add my username in the transfer note?</strong><br>
                This helps us quickly identify your payment and activate your premium access faster.
            </div>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="adminLoginModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeAdminLogin()">&times;</span>
            <h2>Admin Login</h2>
            <div class="input-group">
                <label>Username</label>
                <input type="text" id="adminUsername" placeholder="Admin username">
            </div>
            <div class="input-group">
                <label>Password</label>
                <input type="password" id="adminPassword" placeholder="Admin password">
            </div>
            <button class="btn-primary" onclick="adminLogin()">Login</button>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div id="adminPanelModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeAdminPanel()">&times;</span>
            <h2>Admin Panel</h2>
            
            <div class="nav-tabs">
                <button class="tab-btn active" onclick="showAdminTab('users')">User Management</button>
                <button class="tab-btn" onclick="showAdminTab('payments')">Payment Requests</button>
                <button class="tab-btn" onclick="showAdminTab('stats')">Statistics</button>
            </div>

            <!-- Users Tab -->
            <div id="adminUsers" class="admin-panel">
                <h3>All Users</h3>
                <input type="text" class="search-box" id="userSearch" placeholder="Search by username or email..." onkeyup="filterUsers()">
                <div id="usersList" class="user-list"></div>
            </div>

            <!-- Payments Tab -->
            <div id="adminPayments" class="admin-panel" style="display: none;">
                <h3>Payment Requests</h3>
                <div id="paymentsList" class="user-list"></div>
            </div>

            <!-- Stats Tab -->
            <div id="adminStats" class="admin-panel" style="display: none;">
                <h3>Platform Statistics</h3>
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-label">Total Users</div>
                        <div id="totalUsers" style="font-size: 2em; font-weight: bold;">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Premium Users</div>
                        <div id="premiumUsers" style="font-size: 2em; font-weight: bold; color: #00d4ff;">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Pending Payments</div>
                        <div id="pendingPayments" style="font-size: 2em; font-weight: bold; color: #f5576c;">0</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBzUELxbbaL6Wb_M1uNhjwlZHVTorN9XJs",
            authDomain: "my-whatsapp-2c1af.firebaseapp.com",
            projectId: "my-whatsapp-2c1af",
            storageBucket: "my-whatsapp-2c1af.firebasestorage.app",
            messagingSenderId: "1089455460888",
            appId: "1:1089455460888:web:d0c8dea185ba6769ebe96d"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Global Variables
        let currentUser = null;
        let allUsers = [];
        let allPayments = [];

        // Check Auth State
        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                loadUserData();
            } else {
                document.getElementById('authContainer').style.display = 'block';
                document.getElementById('appContainer').style.display = 'none';
            }
        });

        // Load User Data
        async function loadUserData() {
            try {
                const userDoc = await db.collection('users').doc(currentUser.uid).get();
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    document.getElementById('currentUsername').textContent = userData.username || 'User';
                    document.getElementById('authContainer').style.display = 'none';
                    document.getElementById('appContainer').style.display = 'block';
                    loadPredictions();
                } else {
                    // Create user document if doesn't exist
                    await db.collection('users').doc(currentUser.uid).set({
                        email: currentUser.email,
                        username: currentUser.email.split('@')[0],
                        isPremium: false,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    loadUserData();
                }
            } catch (error) {
                console.error('Error loading user data:', error);
            }
        }

        // Auth Functions
        function switchToSignup() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('signupForm').style.display = 'block';
        }

        function switchToLogin() {
            document.getElementById('signupForm').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
        }

        async function signup() {
            const username = document.getElementById('signupUsername').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value;

            if (!username || !email || !password) {
                alert('Please fill in all fields');
                return;
            }

            if (password.length < 6) {
                alert('Password must be at least 6 characters');
                return;
            }

            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                await db.collection('users').doc(userCredential.user.uid).set({
                    username: username,
                    email: email,
                    isPremium: false,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                alert('Account created successfully!');
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        async function login() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;

            if
                (!email || !password) {
                alert('Please fill in all fields');
                return;
            }

            try {
                await auth.signInWithEmailAndPassword(email, password);
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        function logout() {
            auth.signOut();
        }

        // Tab Functions
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            const btns = document.querySelectorAll('.tab-btn');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            btns.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Load Predictions using Football-Data.org API
        async function loadPredictions() {
            const predictionsLoading = document.getElementById('predictionsLoading');
            const predictionsList = document.getElementById('predictionsList');
            
            try {
                // Using football-data.org API with your token
                const response = await fetch('https://api.football-data.org/v4/matches', {
                    headers: {
                        'X-Auth-Token': '8e0fbe1a3138453096b4a4aae23e301b'
                    }
                });
                
                if (!response.ok) {
                    throw new Error('API request failed');
                }
                
                const data = await response.json();
                
                // Get user's premium status
                const userDoc = await db.collection('users').doc(currentUser.uid).get();
                const isPremium = userDoc.data()?.isPremium || false;
                
                // Filter today's matches
                const today = new Date();
                const todayMatches = data.matches.filter(match => {
                    const matchDate = new Date(match.utcDate);
                    return matchDate.toDateString() === today.toDateString();
                });
                
                // Limit to 3 for free users
                const displayMatches = isPremium ? todayMatches : todayMatches.slice(0, 3);
                
                predictionsLoading.style.display = 'none';
                
                if (displayMatches.length === 0) {
                    predictionsList.innerHTML = '<div class="prediction-card"><h3>No matches scheduled for today. Check back tomorrow!</h3></div>';
                    return;
                }
                
                predictionsList.innerHTML = displayMatches.map((match, index) => {
                    const prediction = generatePrediction(match);
                    return createPredictionCard(match, prediction, isPremium);
                }).join('');
                
                // Show upgrade message for free users
                if (!isPremium && todayMatches.length > 3) {
                    predictionsList.innerHTML += `
                        <div class="prediction-card" style="text-align: center; padding: 40px;">
                            <h2>üîí ${todayMatches.length - 3} More Predictions Available</h2>
                            <p>Upgrade to Premium to unlock all daily predictions and detailed analysis</p>
                            <button class="upgrade-btn" onclick="showTab('upgrade')">Upgrade Now - ‚Ç¶5,000/month</button>
                        </div>
                    `;
                }
                
            } catch (error) {
                console.error('Error loading predictions:', error);
                predictionsLoading.style.display = 'none';
                predictionsList.innerHTML = `
                    <div class="error-msg">
                        Unable to load predictions at the moment. Please try again later.<br>
                        <small>Error: ${error.message}</small>
                    </div>
                `;
            }
        }

        // Generate Prediction Algorithm
        function generatePrediction(match) {
            // Simple algorithm based on team names and random factors
            // In production, you'd use real statistics from API
            
            const homeTeam = match.homeTeam.name;
            const awayTeam = match.awayTeam.name;
            
            // Simulate statistics (replace with real API data in production)
            const homeWinRate = Math.random() * 100;
            const awayWinRate = Math.random() * 100;
            const drawChance = Math.random() * 30;
            
            let prediction, confidence;
            
            if (homeWinRate > awayWinRate + 15) {
                prediction = 'Home Win';
                confidence = Math.min(Math.round(homeWinRate), 85);
            } else if (awayWinRate > homeWinRate + 15) {
                prediction = 'Away Win';
                confidence = Math.min(Math.round(awayWinRate), 85);
            } else {
                prediction = 'Draw or Double Chance';
                confidence = Math.round((homeWinRate + awayWinRate) / 2);
            }
            
            return {
                prediction,
                confidence: Math.max(confidence, 60), // Minimum 60% confidence
                homeForm: Math.round(homeWinRate / 10),
                awayForm: Math.round(awayWinRate / 10),
                homeGoalsAvg: (Math.random() * 2 + 0.5).toFixed(1),
                awayGoalsAvg: (Math.random() * 2 + 0.5).toFixed(1)
            };
        }

        // Create Prediction Card
        function createPredictionCard(match, pred, isPremium) {
            const matchTime = new Date(match.utcDate).toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            const premiumStats = isPremium ? `
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-label">Home Form</div>
                        <div>${'‚≠ê'.repeat(pred.homeForm)}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Away Form</div>
                        <div>${'‚≠ê'.repeat(pred.awayForm)}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Home Goals/Game</div>
                        <div>${pred.homeGoalsAvg}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Away Goals/Game</div>
                        <div>${pred.awayGoalsAvg}</div>
                    </div>
                </div>
            ` : '';
            
            const lockedOverlay = !isPremium ? `
                <div class="locked-overlay">
                    <div class="lock-icon">üîí</div>
                    <h3>Premium Feature</h3>
                    <p>Upgrade to see detailed analysis</p>
                    <button class="upgrade-btn" onclick="showTab('upgrade')">Upgrade Now</button>
                </div>
            ` : '';
            
            return `
                <div class="prediction-card">
                    <div class="match-header">
                        <div>
                            <div class="teams">${match.homeTeam.name} vs ${match.awayTeam.name}</div>
                            <div style="color: #00d4ff; margin-top: 5px;">${match.competition.name} ‚Ä¢ ${matchTime}</div>
                        </div>
                        <div>
                            <div class="prediction">${pred.prediction}</div>
                            ${isPremium ? `<div class="confidence" style="margin-top: 5px;">Confidence: ${pred.confidence}%</div>` : ''}
                        </div>
                    </div>
                    ${premiumStats}
                    ${lockedOverlay}
                </div>
            `;
        }

        // Payment Functions
        function showPaymentModal() {
            document.getElementById('paymentModal').classList.add('active');
        }

        function closePaymentModal() {
            document.getElementById('paymentModal').classList.remove('active');
        }

        async function submitPaymentRequest() {
            const username = document.getElementById('paymentUsername').value.trim();
            
            if (!username) {
                alert('Please enter your username');
                return;
            }
            
            try {
                await db.collection('paymentRequests').add({
                    userId: currentUser.uid,
                    username: username,
                    email: currentUser.email,
                    status: 'pending',
                    amount: 5000,
                    submittedAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                alert('Payment request submitted successfully! Your premium access will be activated within 24 hours after verification.');
                closePaymentModal();
            } catch (error) {
                alert('Error submitting request: ' + error.message);
            }
        }

        // Admin Functions
        function showAdminLogin() {
            document.getElementById('adminLoginModal').classList.add('active');
        }

        function closeAdminLogin() {
            document.getElementById('adminLoginModal').classList.remove('active');
        }

        function adminLogin() {
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            if (username === 'GODSWILL' && password === 'EBERECHI') {
                closeAdminLogin();
                openAdminPanel();
            } else {
                alert('Invalid admin credentials');
            }
        }

        async function openAdminPanel() {
            document.getElementById('adminPanelModal').classList.add('active');
            await loadAllUsers();
            await loadPaymentRequests();
            updateAdminStats();
        }

        function closeAdminPanel() {
            document.getElementById('adminPanelModal').classList.remove('active');
        }

        function showAdminTab(tabName) {
            document.getElementById('adminUsers').style.display = 'none';
            document.getElementById('adminPayments').style.display = 'none';
            document.getElementById('adminStats').style.display = 'none';
            
            document.getElementById('admin' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).style.display = 'block';
            
            const btns = document.querySelectorAll('#adminPanelModal .tab-btn');
            btns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        async function loadAllUsers() {
            try {
                const snapshot = await db.collection('users').get();
                allUsers = [];
                snapshot.forEach(doc => {
                    allUsers.push({ id: doc.id, ...doc.data() });
                });
                displayUsers(allUsers);
            } catch (error) {
                console.error('Error loading users:', error);
            }
        }

        function displayUsers(users) {
            const usersList = document.getElementById('usersList');
            usersList.innerHTML = users.map(user => `
                <div class="user-item">
                    <div class="user-info-detail">
                        <strong>${user.username || 'No username'}</strong><br>
                        <small>${user.email}</small><br>
                        <span class="badge ${user.isPremium ? 'badge-premium' : 'badge-free'}">
                            ${user.isPremium ? 'PREMIUM' : 'FREE'}
                        </span>
                    </div>
                    <div class="user-actions">
                        ${user.isPremium ? 
                            `<button class="btn-small btn-remove" onclick="removePremium('${user.id}', '${user.username}')">Remove Premium</button>` :
                            `<button class="btn-small btn-activate" onclick="activatePremium('${user.id}', '${user.username}')">Activate Premium</button>`
                        }
                    </div>
                </div>
            `).join('');
        }

        function filterUsers() {
            const searchTerm = document.getElementById('userSearch').value.toLowerCase();
            const filtered = allUsers.filter(user => 
                (user.username || '').toLowerCase().includes(searchTerm) ||
                (user.email || '').toLowerCase().includes(searchTerm)
            );
            displayUsers(filtered);
        }

        async function activatePremium(userId, username) {
            if (confirm(`Activate premium for ${username}?`)) {
                try {
                    await db.collection('users').doc(userId).update({
                        isPremium: true,
                        premiumActivatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    alert('Premium activated successfully!');
                    await loadAllUsers();
                    updateAdminStats();
                } catch (error) {
                    alert('Error: ' + error.message);
                }
            }
        }

        async function removePremium(userId, username) {
            if (confirm(`Remove premium from ${username}?`)) {
                try {
                    await db.collection('users').doc(userId).update({
                        isPremium: false
                    });
                    alert('Premium removed successfully!');
                    await loadAllUsers();
                    updateAdminStats();
                } catch (error) {
                    alert('Error: ' + error.message);
                }
            }
        }

        async function loadPaymentRequests() {
            try {
                const snapshot = await db.collection('paymentRequests').orderBy('submittedAt', 'desc').get();
                allPayments = [];
                snapshot.forEach(doc => {
                    allPayments.push({ id: doc.id, ...doc.data() });
                });
                displayPayments(allPayments);
            } catch (error) {
                console.error('Error loading payments:', error);
            }
        }

        function displayPayments(payments) {
            const paymentsList = document.getElementById('paymentsList');
            if (payments.length === 0) {
                paymentsList.innerHTML = '<div class="user-item">No payment requests</div>';
                return;
            }
            
            paymentsList.innerHTML = payments.map(payment => `
                <div class="user-item">
                    <div class="user-info-detail">
                        <strong>${payment.username}</strong><br>
                        <small>${payment.email}</small><br>
                        <small>Amount: ‚Ç¶${payment.amount}</small><br>
                        <span class="badge ${payment.status === 'pending' ? 'badge-free' : 'badge-premium'}">
                            ${payment.status.toUpperCase()}
                        </span>
                    </div>
                    <div class="user-actions">
                        ${payment.status === 'pending' ? 
                            `<button class="btn-small btn-activate" onclick="approvePayment('${payment.id}', '${payment.userId}', '${payment.username}')">Approve</button>
                             <button class="btn-small btn-remove" onclick="rejectPayment('${payment.id}')">Reject</button>` :
                            `<small>${payment.status}</small>`
                        }
                    </div>
                </div>
            `).join('');
        }

        async function approvePayment(paymentId, userId, username) {
            if (confirm(`Approve payment and activate premium for ${username}?`)) {
                try {
                    await db.collection('paymentRequests').doc(paymentId).update({
                        status: 'approved',
                        approvedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    await db.collection('users').doc(userId).update({
                        isPremium: true,
                        premiumActivatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    alert('Payment approved and premium activated!');
                    await loadPaymentRequests();
                    await loadAllUsers();
                    updateAdminStats();
                } catch (error) {
                    alert('Error: ' + error.message);
                }
            }
        }

        async function rejectPayment(paymentId) {
            if (confirm('Reject this payment request?')) {
                try {
                    await db.collection('paymentRequests').doc(paymentId).update({
                        status: 'rejected',
                        rejectedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    alert('Payment rejected');
                    await loadPaymentRequests();
                    updateAdminStats();
                } catch (error) {
                    alert('Error: ' + error.message);
                }
            }
        }

        function updateAdminStats() {
            const totalUsers = allUsers.length;
            const premiumUsers = allUsers.filter(u => u.isPremium).length;
            const pendingPayments = allPayments.filter(p => p.status === 'pending').length;
            
            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('premiumUsers').textContent = premiumUsers;
            document.getElementById('pendingPayments').textContent = pendingPayments;
        }
    </script>
</body>
</html>
