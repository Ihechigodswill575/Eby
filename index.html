<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GODSWILLFLASHSCORE - Premium Sports Predictions</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #0a0e27;
            color: #fff;
            min-height: 100vh;
        }

        .bg-gradient {
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 50%, #0a0e27 100%);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
        }

        .bg-gradient::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(255, 121, 63, 0.1) 0%, transparent 50%);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: rgba(26, 31, 58, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 25px 40px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        header h1 {
            font-size: 2em;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
            letter-spacing: 1px;
        }

        .user-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(26, 31, 58, 0.6);
            backdrop-filter: blur(10px);
            padding: 15px 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .user-badge {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .premium-tag {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .logout-btn {
            background: rgba(255, 59, 92, 0.15);
            border: 1px solid rgba(255, 59, 92, 0.3);
            padding: 10px 24px;
            border-radius: 12px;
            color: #ff3b5c;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: rgba(255, 59, 92, 0.25);
            transform: translateY(-2px);
        }

        .nav-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 30px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .tab-btn {
            padding: 14px 28px;
            background: rgba(26, 31, 58, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab-btn:hover {
            background: rgba(102, 126, 234, 0.2);
            border-color: rgba(102, 126, 234, 0.4);
            color: #fff;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: transparent;
            color: #fff;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.4s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .league-browser {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .league-card {
            background: rgba(26, 31, 58, 0.6);
            padding: 15px 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .league-card:hover {
            background: rgba(102, 126, 234, 0.2);
            border-color: rgba(102, 126, 234, 0.4);
            transform: translateY(-2px);
        }

        .league-card.selected {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3) 0%, rgba(118, 75, 162, 0.3) 100%);
            border-color: #667eea;
        }

        .league-flag {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(102, 126, 234, 0.2);
            font-size: 20px;
        }

        .match-card {
            background: rgba(26, 31, 58, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .match-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .match-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
            border-color: rgba(102, 126, 234, 0.3);
        }

        .match-card:hover::before {
            opacity: 1;
        }

        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            gap: 15px;
        }

        .league-info {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #667eea;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .league-badge {
            width: 24px;
            height: 24px;
            background: rgba(102, 126, 234, 0.2);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .club-badge {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: contain;
            background: rgba(255, 255, 255, 0.1);
        }

        .teams-container {
            flex: 1;
        }

        .teams {
            font-size: 1.4em;
            font-weight: 700;
            margin-bottom: 8px;
            line-height: 1.3;
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .match-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            margin-left: 10px;
        }

        .status-live {
            background: #ff4444;
            animation: pulse 2s infinite;
        }

        .status-finished {
            background: rgba(255, 255, 255, 0.2);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .match-time {
            color: rgba(255, 255, 255, 0.5);
            font-size: 14px;
            font-weight: 500;
        }

        .prediction-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            min-width: 200px;
        }

        .confidence-bar {
            margin-top: 8px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }

        .confidence-meter {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin-top: 6px;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            transition: width 1s ease;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }

        .stat-box {
            background: rgba(0, 0, 0, 0.3);
            padding: 14px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .stat-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-value {
            font-size: 18px;
            font-weight: 700;
            color: #667eea;
        }

        .table-container {
            margin-top: 20px;
            overflow-x: auto;
        }

        .league-table {
            width: 100%;
            border-collapse: collapse;
        }

        .league-table th,
        .league-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .league-table th {
            background: rgba(0, 0, 0, 0.3);
            color: #667eea;
            font-weight: 700;
            font-size: 12px;
            text-transform: uppercase;
        }

        .league-table tr:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .table-position {
            width: 40px;
            text-align: center;
            font-weight: 700;
            color: #667eea;
        }

        .premium-lock {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 14, 39, 0.95);
            backdrop-filter: blur(8px);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-radius: 16px;
            z-index: 10;
        }

        .lock-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.8;
        }

        .upgrade-cta {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: #fff;
            padding: 16px 40px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
            box-shadow: 0 6px 20px rgba(245, 87, 108, 0.4);
        }

        .upgrade-cta:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(245, 87, 108, 0.6);
        }

        .auth-container {
            max-width: 480px;
            margin: 60px auto;
            background: rgba(26, 31, 58, 0.8);
            backdrop-filter: blur(20px);
            padding: 50px 40px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
        }

        .auth-container h2 {
            text-align: center;
            margin-bottom: 40px;
            font-size: 2em;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .input-group {
            margin-bottom: 24px;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
        }

        .input-group input {
            width: 100%;
            padding: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
            font-size: 15px;
            transition: all 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.08);
        }

        .input-group input::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }

        .btn-primary {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        .switch-auth {
            text-align: center;
            margin-top: 24px;
            color: rgba(255, 255, 255, 0.6);
        }

        .switch-auth a {
            color: #667eea;
            cursor: pointer;
            text-decoration: none;
            font-weight: 600;
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 24px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-msg {
            background: rgba(255, 59, 92, 0.15);
            border: 1px solid rgba(255, 59, 92, 0.3);
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
            color: #ff6b8a;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: rgba(26, 31, 58, 0.95);
            backdrop-filter: blur(20px);
            padding: 40px;
            border-radius: 20px;
            max-width: 600px;
            width: 100%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 28px;
            cursor: pointer;
            color: rgba(255, 255, 255, 0.5);
            transition: color 0.3s;
        }

        .close-modal:hover {
            color: #ff3b5c;
        }

        .payment-card {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid #667eea;
            padding: 24px;
            border-radius: 12px;
            margin: 24px 0;
        }

        .payment-detail {
            display: flex;
            justify-content: space-between;
            padding: 14px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }

        .payment-detail strong {
            color: #667eea;
        }

        .important-box {
            background: rgba(255, 87, 108, 0.15);
            border: 2px solid #f5576c;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .developer-credit {
            text-align: center;
            margin-top: 40px;
            padding: 24px;
            background: rgba(26, 31, 58, 0.6);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 14px;
            line-height: 1.8;
        }

        .developer-credit a {
            color: #667eea;
            text-decoration: none;
        }

        .admin-menu {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            z-index: 1000;
            opacity: 0.1;
            transition: opacity 0.3s;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 5px;
            padding: 10px;
            background: rgba(26, 31, 58, 0.8);
            border-radius: 8px;
        }

        .admin-menu:hover {
            opacity: 1;
        }

        .hamburger {
            width: 20px;
            height: 3px;
            background: #667eea;
            border-radius: 2px;
        }

        .admin-panel {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .user-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .user-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .user-info-detail {
            flex: 1;
        }

        .user-actions {
            display: flex;
            gap: 10px;
        }

        .badge {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .badge-premium {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .badge-free {
            background: rgba(255, 255, 255, 0.2);
        }

        .btn-small {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn-activate {
            background: #667eea;
            color: #fff;
        }

        .btn-remove {
            background: #ff4444;
            color: #fff;
        }

        .btn-small:hover {
            transform: scale(1.05);
        }

        .search-box {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 16px;
        }

        .refresh-indicator {
            display: inline-block;
            color: rgba(255, 255, 255, 0.5);
            font-size: 12px;
            margin-left: 15px;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.5em;
            }

            .teams {
                font-size: 1.1em;
            }

            .match-header {
                flex-direction: column;
            }

            .prediction-badge {
                width: 100%;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .user-item {
                flex-direction: column;
                align-items: flex-start;
            }

            .user-actions {
                width: 100%;
            }

            .league-browser {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="bg-gradient"></div>

    <div class="admin-menu" onclick="showAdminLogin()">
        <div class="hamburger"></div>
        <div class="hamburger"></div>
        <div class="hamburger"></div>
    </div>

    <div id="authContainer" class="auth-container">
        <h2>GODSWILLFLASHSCORE</h2>
        
        <div id="loginForm">
            <div class="input-group">
                <label>Email</label>
                <input type="email" id="loginEmail" placeholder="Enter your email">
            </div>
            <div class="input-group">
                <label>Password</label>
                <input type="password" id="loginPassword" placeholder="Enter your password">
            </div>
            <button class="btn-primary" onclick="login()">Login</button>
            <div class="switch-auth">
                Don't have an account? <a onclick="switchToSignup()">Sign Up</a>
            </div>
        </div>

        <div id="signupForm" style="display: none;">
            <div class="input-group">
                <label>Username</label>
                <input type="text" id="signupUsername" placeholder="Choose a username">
            </div>
            <div class="input-group">
                <label>Email</label>
                <input type="email" id="signupEmail" placeholder="Enter your email">
            </div>
            <div class="input-group">
                <label>Password</label>
                <input type="password" id="signupPassword" placeholder="Create a password (min 6 characters)">
            </div>
            <button class="btn-primary" onclick="signup()">Sign Up</button>
            <div class="switch-auth">
                Already have an account? <a onclick="switchToLogin()">Login</a>
            </div>
        </div>

        <div class="developer-credit">
            <strong>Created by "·¥Ö·¥á·¥†…¢·¥è·¥ÖÍú±·¥°…™ ü ü"</strong><br>
            üìß <a href="mailto:Ihechigodswill575@gmail.com">Ihechigodswill575@gmail.com</a><br>
            üëª Snapchat: <strong>KIZOELITE_2</strong>
        </div>
    </div>

    <div id="appContainer" class="container" style="display: none;">
        <header>
            <h1>GODSWILLFLASHSCORE <span class="refresh-indicator" id="refreshIndicator">‚ü≥ Auto-refresh: 2:00</span></h1>
        </header>

        <div class="user-bar">
            <div class="user-badge">
                <span>Welcome, <strong id="currentUsername"></strong></span>
                <span id="premiumBadge" style="display: none;" class="premium-tag">Premium</span>
            </div>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>

        <div class="nav-tabs">
            <button class="tab-btn active" onclick="showTab('predictions')">Today's Matches</button>
            <button class="tab-btn" onclick="showTab('leagues')">League Browser</button>
            <button class="tab-btn" onclick="showTab('tables')">League Tables</button>
            <button class="tab-btn" onclick="showTab('upgrade')">‚≠ê Upgrade</button>
        </div>

        <div id="predictions" class="tab-content active">
            <div id="predictionsLoading" class="loading">
                <div class="spinner"></div>
                <p>Loading today's predictions...</p>
            </div>
            <div id="predictionsList"></div>
        </div>

        <div id="leagues" class="tab-content">
            <h2 style="margin-bottom: 20px;">Browse Leagues</h2>
            <div id="leagueBrowser" class="league-browser"></div>
            <div id="leagueMatches"></div>
        </div>

        <div id="tables" class="tab-content">
            <h2 style="margin-bottom: 20px;">League Tables</h2>
            <div id="tablesContent"></div>
        </div>

        <div id="upgrade" class="tab-content">
            <div class="match-card">
                <h2>‚≠ê Upgrade to Premium</h2>
                <h3 style="color: #667eea; margin: 20px 0; font-size: 2em;">‚Ç¶5,000/month</h3>
                
                <div style="margin: 30px 0;">
                    <h3>Premium Features:</h3>
                    <div class="stats-grid" style="margin-top: 20px;">
                        <div class="stat-box">
                            <div class="stat-label">Daily Predictions</div>
                            <div class="stat-value">Unlimited</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">All Leagues</div>
                            <div class="stat-value">10+</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Live Scores</div>
                            <div class="stat-value">Real-time</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Team Stats
                                <div class="stat-value">Detailed</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">League Tables</div>
                            <div class="stat-value">All 10</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Auto Refresh</div>
                            <div class="stat-value">2 mins</div>
                        </div>
                    </div>
                </div>

                <button class="upgrade-cta" onclick="showPaymentModal()" style="width: 100%; margin-top: 30px;">Proceed to Payment</button>
            </div>
        </div>
    </div>

    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closePaymentModal()">&times;</span>
            <h2>Upgrade to Premium</h2>
            
            <div class="payment-card">
                <h3 style="color: #667eea; margin-bottom: 20px;">Payment Instructions</h3>
                <p><strong>Step 1:</strong> Transfer ‚Ç¶5,000 to:</p>
                <div class="payment-detail">
                    <span><strong>Bank:</strong></span>
                    <span>PalmPay</span>
                </div>
                <div class="payment-detail">
                    <span><strong>Account Number:</strong></span>
                    <span>8145688688</span>
                </div>
                <div class="payment-detail">
                    <span><strong>Account Name:</strong></span>
                    <span>OGECHI CHINONSO OKONKWO</span>
                </div>
            </div>

            <div class="important-box">
                <strong>‚ö†Ô∏è IMPORTANT - Step 2:</strong><br><br>
                Write your username in the <strong>Note/Description</strong> field when making the transfer.
            </div>

            <div class="input-group" style="margin-top: 24px;">
                <label>Confirm Your Username:</label>
                <input type="text" id="paymentUsername" placeholder="Enter your username">
            </div>

            <button class="btn-primary" onclick="submitPaymentRequest()">Submit Payment Request</button>

            <p style="margin-top: 20px; font-size: 14px; color: rgba(255, 255, 255, 0.6); text-align: center;">
                Premium access will be activated within 24 hours after verification
            </p>
        </div>
    </div>

    <div id="adminLoginModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeAdminLogin()">&times;</span>
            <h2>Admin Login</h2>
            <div class="input-group">
                <label>Username</label>
                <input type="text" id="adminUsername" placeholder="Admin username">
            </div>
            <div class="input-group">
                <label>Password</label>
                <input type="password" id="adminPassword" placeholder="Admin password">
            </div>
            <button class="btn-primary" onclick="adminLogin()">Login</button>
        </div>
    </div>

    <div id="adminPanelModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <span class="close-modal" onclick="closeAdminPanel()">&times;</span>
            <h2>Admin Panel</h2>
            
            <div class="admin-content">
                <div class="nav-tabs">
                    <button class="tab-btn active" onclick="showAdminTab('users')">User Management</button>
                    <button class="tab-btn" onclick="showAdminTab('payments')">Payment Requests</button>
                    <button class="tab-btn" onclick="showAdminTab('stats')">Statistics</button>
                </div>

                <div id="adminUsers" class="admin-panel">
                    <h3>All Users</h3>
                    <input type="text" class="search-box" id="userSearch" placeholder="Search by username or email..." onkeyup="filterUsers()">
                    <div id="usersList" class="user-list"></div>
                </div>

                <div id="adminPayments" class="admin-panel" style="display: none;">
                    <h3>Payment Requests</h3>
                    <div id="paymentsList" class="user-list"></div>
                </div>

                <div id="adminStats" class="admin-panel" style="display: none;">
                    <h3>Platform Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-label">Total Users</div>
                            <div id="totalUsers" style="font-size: 2em; font-weight: bold;">0</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Premium Users</div>
                            <div id="premiumUsers" style="font-size: 2em; font-weight: bold; color: #667eea;">0</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Pending Payments</div>
                            <div id="pendingPayments" style="font-size: 2em; font-weight: bold; color: #f5576c;">0</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBzUELxbbaL6Wb_M1uNhjwlZHVTorN9XJs",
            authDomain: "my-whatsapp-2c1af.firebaseapp.com",
            projectId: "my-whatsapp-2c1af",
            storageBucket: "my-whatsapp-2c1af.firebasestorage.app",
            messagingSenderId: "1089455460888",
            appId: "1:1089455460888:web:d0c8dea185ba6769ebe96d"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // FOOTBALL-DATA.ORG API CONFIGURATION
        const API_CONFIG = {
            API_KEY: '8e0fbe1a3138453096b4a4aae23e301b',
            BASE_URL: 'https://api.football-data.org/v4',
            CACHE_DURATION: 2 * 60 * 1000, // 2 minutes
            REFRESH_INTERVAL: 2 * 60 * 1000 // 2 minutes
        };

        // Cache system
        const cache = {
            data: {},
            timestamps: {}
        };

        // Global variables
        let currentUser = null;
        let allUsers = [];
        let allPayments = [];
        let allMatches = [];
        let selectedLeague = null;
        let refreshInterval = null;
        let countdownInterval = null;
        let secondsRemaining = 120;

        // Football-Data.org League IDs (different from API-Sports)
        const LEAGUES = [
            { id: 'PL', name: 'Premier League', country: 'England', flag: 'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø', fdId: 2021 },
            { id: 'PD', name: 'La Liga', country: 'Spain', flag: 'üá™üá∏', fdId: 2014 },
            { id: 'BL1', name: 'Bundesliga', country: 'Germany', flag: 'üá©üá™', fdId: 2002 },
            { id: 'SA', name: 'Serie A', country: 'Italy', flag: 'üáÆüáπ', fdId: 2019 },
            { id: 'FL1', name: 'Ligue 1', country: 'France', flag: 'üá´üá∑', fdId: 2015 },
            { id: 'CL', name: 'Champions League', country: 'Europe', flag: 'üá™üá∫', fdId: 2001 },
            { id: 'ELC', name: 'Championship', country: 'England', flag: 'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø', fdId: 2016 },
            { id: 'PPL', name: 'Primeira Liga', country: 'Portugal', flag: 'üáµüáπ', fdId: 2017 },
            { id: 'DED', name: 'Eredivisie', country: 'Netherlands', flag: 'üá≥üá±', fdId: 2003 },
            { id: 'BSA', name: 'Brasileir√£o', country: 'Brazil', flag: 'üáßüá∑', fdId: 2013 }
        ];

        // Check if cache is valid
        function isCacheValid(key) {
            const timestamp = cache.timestamps[key];
            if (!timestamp) return false;
            return (Date.now() - timestamp) < API_CONFIG.CACHE_DURATION;
        }

        // Get from cache or fetch new data
        async function getCachedOrFetch(key, fetchFunction) {
            if (isCacheValid(key)) {
                console.log(`Using cached data for: ${key}`);
                return cache.data[key];
            }

            console.log(`Fetching fresh data for: ${key}`);
            const data = await fetchFunction();
            cache.data[key] = data;
            cache.timestamps[key] = Date.now();
            return data;
        }

        // Make API call to Football-Data.org
        async function makeAPICall(endpoint) {
            const url = `${API_CONFIG.BASE_URL}${endpoint}`;
            
            try {
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'X-Auth-Token': API_CONFIG.API_KEY
                    }
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status} ${response.statusText}`);
                }

                return await response.json();
            } catch (error) {
                console.error('API Call failed:', error);
                throw error;
            }
        }

        // Start auto-refresh countdown
        function startRefreshCountdown() {
            secondsRemaining = 120;
            
            if (countdownInterval) {
                clearInterval(countdownInterval);
            }

            countdownInterval = setInterval(() => {
                secondsRemaining--;
                const minutes = Math.floor(secondsRemaining / 60);
                const seconds = secondsRemaining % 60;
                const indicator = document.getElementById('refreshIndicator');
                if (indicator) {
                    indicator.textContent = `‚ü≥ Auto-refresh: ${minutes}:${seconds.toString().padStart(2, '0')}`;
                }

                if (secondsRemaining <= 0) {
                    secondsRemaining = 120;
                }
            }, 1000);
        }

        // Start auto-refresh for matches
        function startAutoRefresh() {
            if (refreshInterval) {
                clearInterval(refreshInterval);
            }

            startRefreshCountdown();

            refreshInterval = setInterval(() => {
                console.log('Auto-refreshing data...');
                loadPredictions();
                startRefreshCountdown();
            }, API_CONFIG.REFRESH_INTERVAL);
        }

        // Stop auto-refresh
        function stopAutoRefresh() {
            if (refreshInterval) {
                clearInterval(refreshInterval);
                refreshInterval = null;
            }
            if (countdownInterval) {
                clearInterval(countdownInterval);
                countdownInterval = null;
            }
        }

        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                loadUserData();
            } else {
                stopAutoRefresh();
                document.getElementById('authContainer').style.display = 'block';
                document.getElementById('appContainer').style.display = 'none';
            }
        });

        async function loadUserData() {
            try {
                const userDoc = await db.collection('users').doc(currentUser.uid).get();
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    document.getElementById('currentUsername').textContent = userData.username || 'User';
                    
                    if (userData.isPremium) {
                        document.getElementById('premiumBadge').style.display = 'inline-block';
                    }
                    
                    document.getElementById('authContainer').style.display = 'none';
                    document.getElementById('appContainer').style.display = 'block';
                    loadPredictions();
                    initializeLeagueBrowser();
                    startAutoRefresh();
                } else {
                    await db.collection('users').doc(currentUser.uid).set({
                        email: currentUser.email,
                        username: currentUser.email.split('@')[0],
                        isPremium: false,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    loadUserData();
                }
            } catch (error) {
                console.error('Error loading user data:', error);
            }
        }

        function switchToSignup() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('signupForm').style.display = 'block';
        }

        function switchToLogin() {
            document.getElementById('signupForm').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
        }

        async function signup() {
            const username = document.getElementById('signupUsername').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value;

            if (!username || !email || !password) {
                alert('Please fill in all fields');
                return;
            }

            if (password.length < 6) {
                alert('Password must be at least 6 characters');
                return;
            }

            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                await db.collection('users').doc(userCredential.user.uid).set({
                    username: username,
                    email: email,
                    isPremium: false,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                alert('Account created successfully!');
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        async function login() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;

            if (!email || !password) {
                alert('Please fill in all fields');
                return;
            }

            try {
                await auth.signInWithEmailAndPassword(email, password);
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        function logout() {
            stopAutoRefresh();
            auth.signOut();
        }

        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            const btns = document.querySelectorAll('.tab-btn');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            btns.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            if (tabName === 'tables') {
                loadLeagueTables();
            }
        }

        function initializeLeagueBrowser() {
            const browser = document.getElementById('leagueBrowser');
            browser.innerHTML = LEAGUES.map(league => `
                <div class="league-card" onclick="selectLeague('${league.id}', '${league.name}')">
                    <div class="league-flag">${league.flag}</div>
                    <div>
                        <strong>${league.name}</strong><br>
                        <small style="color: rgba(255, 255, 255, 0.5);">${league.country}</small>
                    </div>
                </div>
            `).join('');
        }

        async function selectLeague(leagueId, leagueName) {
            selectedLeague = leagueId;
            
            document.querySelectorAll('.league-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');

            const leagueMatches = document.getElementById('leagueMatches');
            leagueMatches.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Loading ${leagueName} matches...</p>
                </div>
            `;

            const userDoc = await db.collection('users').doc(currentUser.uid).get();
            const isPremium = userDoc.data()?.isPremium || false;

            if (!isPremium) {
                leagueMatches.innerHTML = `
                    <div class="match-card">
                        <div class="premium-lock" style="position: relative; min-height: 300px;">
                            <div class="lock-icon">üîí</div>
                            <h3>Premium Feature</h3>
                            <p>Upgrade to access league-specific matches and analysis</p>
                            <button class="upgrade-cta" onclick="showTab('upgrade')">Upgrade to Premium</button>
                        </div>
                    </div>
                `;
                return;
            }

            try {
                const league = LEAGUES.find(l => l.id === leagueId);
                const cacheKey = `league_matches_${leagueId}`;
                
                const data = await getCachedOrFetch(cacheKey, async () => {
                    return await makeAPICall(`/competitions/${leagueId}/matches?status=SCHEDULED,LIVE,IN_PLAY,PAUSED,FINISHED`);
                });
                
                if (data.matches && data.matches.length > 0) {
                    displayLeagueMatches(data.matches, isPremium);
                } else {
                    leagueMatches.innerHTML = `
                        <div class="match-card">
                            <h3 style="text-align: center;">No matches available for ${leagueName}</h3>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading league matches:', error);
                leagueMatches.innerHTML = `
                    <div class="error-msg">
                        <h3>Unable to load league matches</h3>
                        <p style="margin-top: 10px;">Error: ${error.message}</p>
                    </div>
                `;
            }
        }

        function displayLeagueMatches(matches, isPremium) {
            const leagueMatches = document.getElementById('leagueMatches');
            const matchCards = matches.slice(0, isPremium ? 50 : 5).map(match => createMatchCard(match, isPremium));
            leagueMatches.innerHTML = matchCards.join('');
        }

        async function loadPredictions() {
            const predictionsLoading = document.getElementById('predictionsLoading');
            const predictionsList = document.getElementById('predictionsList');
            
            try {
                predictionsLoading.style.display = 'block';
                predictionsList.innerHTML = '';

                const userDoc = await db.collection('users').doc(currentUser.uid).get();
                const isPremium = userDoc.data()?.isPremium || false;

                const cacheKey = 'all_matches_today';
                const data = await getCachedOrFetch(cacheKey, async () => {
                    const today = getTodayDate();
                    return await makeAPICall(`/matches?date=${today}`);
                });
                
                let matches = data.matches || [];
                allMatches = matches;

                predictionsLoading.style.display = 'none';

                if (matches.length === 0) {
                    predictionsList.innerHTML = `
                        <div class="match-card">
                            <h3 style="text-align: center;">No matches scheduled for today</h3>
                            <p style="text-align: center; color: rgba(255, 255, 255, 0.5); margin-top: 10px;">
                                Check back tomorrow or browse leagues
                            </p>
                        </div>
                    `;
                    return;
                }

                // Filter for major leagues
                const majorMatches = matches.filter(m => 
                    LEAGUES.some(league => league.id === m.competition.code)
                );

                const displayMatches = isPremium ? majorMatches : majorMatches.slice(0, 6);
                const matchCards = displayMatches.map(match => createMatchCard(match, isPremium));

                predictionsList.innerHTML = matchCards.join('');

                if (!isPremium && majorMatches.length > 6) {
                    predictionsList.innerHTML += `
                        <div class="match-card" style="text-align: center; padding: 60px 40px; background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);">
                            <div style="font-size: 48px; margin-bottom: 20px;">üîí</div>
                            <h2 style="margin-bottom: 16px;">+${majorMatches.length - 6} More Predictions Available</h2>
                            <p style="color: rgba(255, 255, 255, 0.6); margin-bottom: 30px; font-size: 16px;">
                                Unlock all daily predictions with real-time data and expert analysis
                            </p>
                            <button class="upgrade-cta" onclick="showTab('upgrade')">Upgrade to Premium - ‚Ç¶5,000/month</button>
                        </div>
                    `;
                }

            } catch (error) {
                console.error('Error loading predictions:', error);
                predictionsLoading.style.display = 'none';
                predictionsList.innerHTML = `
                    <div class="error-msg">
                        <h3>Unable to load predictions</h3>
                        <p style="margin-top: 10px;">Error: ${error.message}</p>
                        <button class="upgrade-cta" onclick="loadPredictions()" style="margin-top: 20px;">Retry</button>
                    </div>
                `;
            }
        }

        function createMatchCard(match, isPremium) {
            const matchDate = new Date(match.utcDate);
            const matchTime = matchDate.toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: true
            });

            let statusBadge = '';
            let scoreDisplay = '';
            
            if (match.status === 'IN_PLAY' || match.status === 'PAUSED') {
                statusBadge = `<span class="match-status status-live">‚óè LIVE</span>`;
                if (match.score.fullTime.home !== null) {
                    scoreDisplay = `<div style="font-size: 2em; font-weight: 800; color: #667eea; margin: 10px 0;">${match.score.fullTime.home} - ${match.score.fullTime.away}</div>`;
                }
            } else if (match.status === 'FINISHED') {
                statusBadge = `<span class="match-status status-finished">FINISHED</span>`;
                if (match.score.fullTime.home !== null) {
                    scoreDisplay = `<div style="font-size: 2em; font-weight: 800; color: rgba(255, 255, 255, 0.7); margin: 10px 0;">${match.score.fullTime.home} - ${match.score.fullTime.away}</div>`;
                }
            }

            // Generate AI prediction
            const prediction = generatePrediction(match);
            const confidence = Math.floor(Math.random() * 20) + 65; // 65-85%

            let premiumStats = '';
            if (isPremium) {
                premiumStats = `
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-label">Competition</div>
                            <div class="stat-value">${match.competition.name}</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Matchday</div>
                            <div class="stat-value">${match.matchday || 'N/A'}</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Venue</div>
                            <div class="stat-value">${match.venue || 'TBD'}</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Referee</div>
                            <div class="stat-value">${match.referees?.[0]?.name || 'TBD'}</div>
                        </div>
                    </div>
                `;
            }

            const premiumLock = !isPremium ? `
                <div class="premium-lock">
                    <div class="lock-icon">üîí</div>
                    <h3>Detailed Analysis Locked</h3>
                    <p style="margin-top: 12px; color: rgba(255, 255, 255, 0.7);">Upgrade to view full statistics and predictions</p>
                    <button class="upgrade-cta" onclick="showTab('upgrade')">Upgrade Now</button>
                </div>
            ` : '';

            return `
                <div class="match-card">
                    <div class="league-info">
                        <div class="league-badge">‚öΩ</div>
                        <span>${match.competition.name}</span>
                        ${statusBadge}
                    </div>
                    
                    <div class="match-header">
                        <div class="teams-container">
                            <div class="teams">
                                <span>${match.homeTeam.name} vs ${match.awayTeam.name}</span>
                            </div>
                            ${scoreDisplay}
                            <div class="match-time">üïê ${matchTime}</div>
                        </div>
                        
                        <div class="prediction-badge">
                            <div>${prediction}</div>
                            <div class="confidence-bar">
                                ${confidence}% Confidence
                                <div class="confidence-meter">
                                    <div class="confidence-fill" style="width: ${confidence}%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    ${premiumStats}
                    ${premiumLock}
                </div>
            `;
        }

        function generatePrediction(match) {
            // Simple AI prediction logic based on team names and random factors
            const predictions = [
                'Home Win',
                'Away Win',
                'Draw',
                'Over 2.5 Goals',
                'Both Teams to Score',
                'Under 2.5 Goals'
            ];
            
            // Weighted prediction based on home advantage
            const rand = Math.random();
            if (rand < 0.4) return 'Home Win';
            if (rand < 0.7) return 'Both Teams to Score';
            if (rand < 0.85) return 'Over 2.5 Goals';
            return predictions[Math.floor(Math.random() * predictions.length)];
        }

        async function loadLeagueTables() {
            const tablesContent = document.getElementById('tablesContent');
            
            const userDoc = await db.collection('users').doc(currentUser.uid).get();
            const isPremium = userDoc.data()?.isPremium || false;

            if (!isPremium) {
                tablesContent.innerHTML = `
                    <div class="match-card">
                        <div class="premium-lock" style="position: relative; min-height: 400px;">
                            <div class="lock-icon">üîí</div>
                            <h3>Premium Feature</h3>
                            <p>Upgrade to access real-time league tables</p>
                            <button class="upgrade-cta" onclick="showTab('upgrade')">Upgrade to Premium</button>
                        </div>
                    </div>
                `;
                return;
            }

            tablesContent.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Loading league tables...</p>
                </div>
            `;

            try {
                const tables = [];
                
                // Load tables for top 5 leagues
                const topLeagues = LEAGUES.slice(0, 5);
                
                for (const league of topLeagues) {
                    try {
                        const cacheKey = `standings_${league.id}`;
                        const data = await getCachedOrFetch(cacheKey, async () => {
                            return await makeAPICall(`/competitions/${league.id}/standings`);
                        });
                        
                        if (data.standings && data.standings.length > 0) {
                            tables.push(displayLeagueTable(data, league));
                        }
                        
                        // Small delay to avoid overwhelming the API
                        await new Promise(resolve => setTimeout(resolve, 200));
                    } catch (error) {
                        console.log(`Error loading table for ${league.name}:`, error);
                    }
                }

                if (tables.length === 0) {
                    throw new Error('No tables available');
                }

                tablesContent.innerHTML = tables.join('');

            } catch (error) {
                console.error('Error loading tables:', error);
                tablesContent.innerHTML = `
                    <div class="error-msg">
                        <h3>Unable to load league tables</h3>
                        <p style="margin-top: 10px;">Error: ${error.message}</p>
                    </div>
                `;
            }
        }

        function displayLeagueTable(data, league) {
            const standings = data.standings[0].table;
            
            return `
                <div class="match-card" style="margin-bottom: 30px;">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px;">
                        <div class="league-flag">${league.flag}</div>
                        <div>
                            <h3>${league.name}</h3>
                            <small style="color: rgba(255, 255, 255, 0.5);">${league.country}</small>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="league-table">
                            <thead>
                                <tr>
                                    <th class="table-position">#</th>
                                    <th>Team</th>
                                    <th>P</th>
                                    <th>W</th
                                    >
                                    <th>D</th>
                                    <th>L</th>
                                    <th>GF</th>
                                    <th>GA</th>
                                    <th>GD</th>
                                    <th>Pts</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${standings.map(team => `
                                    <tr>
                                        <td class="table-position">${team.position}</td>
                                        <td>
                                            <div style="display: flex; align-items: center; gap: 10px;">
                                                <span>${team.team.crest ? `<img src="${team.team.crest}" alt="${team.team.name}" style="width: 24px; height: 24px;">` : '‚öΩ'}</span>
                                                <strong>${team.team.name}</strong>
                                            </div>
                                        </td>
                                        <td>${team.playedGames}</td>
                                        <td>${team.won}</td>
                                        <td>${team.draw}</td>
                                        <td>${team.lost}</td>
                                        <td>${team.goalsFor}</td>
                                        <td>${team.goalsAgainst}</td>
                                        <td style="color: ${team.goalDifference > 0 ? '#4CAF50' : team.goalDifference < 0 ? '#f44336' : 'inherit'}">
                                            ${team.goalDifference > 0 ? '+' : ''}${team.goalDifference}
                                        </td>
                                        <td><strong>${team.points}</strong></td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function getTodayDate() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        function showPaymentModal() {
            document.getElementById('paymentModal').classList.add('active');
        }

        function closePaymentModal() {
            document.getElementById('paymentModal').classList.remove('active');
        }

        async function submitPaymentRequest() {
            const username = document.getElementById('paymentUsername').value.trim();
            
            if (!username) {
                alert('Please enter your username');
                return;
            }
            
            try {
                await db.collection('paymentRequests').add({
                    userId: currentUser.uid,
                    username: username,
                    email: currentUser.email,
                    status: 'pending',
                    amount: 5000,
                    submittedAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                alert('‚úÖ Payment request submitted successfully!\n\nYour premium access will be activated within 24 hours after payment verification.\n\nThank you for upgrading!');
                closePaymentModal();
            } catch (error) {
                alert('‚ùå Error submitting request: ' + error.message);
            }
        }

        function showAdminLogin() {
            document.getElementById('adminLoginModal').classList.add('active');
        }

        function closeAdminLogin() {
            document.getElementById('adminLoginModal').classList.remove('active');
        }

        function adminLogin() {
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            if (username === 'GODSWILL' && password === 'EBERECHI') {
                closeAdminLogin();
                openAdminPanel();
            } else {
                alert('Invalid admin credentials');
            }
        }

        async function openAdminPanel() {
            document.getElementById('adminPanelModal').classList.add('active');
            await loadAllUsers();
            await loadPaymentRequests();
            updateAdminStats();
        }

        function closeAdminPanel() {
            document.getElementById('adminPanelModal').classList.remove('active');
        }

        function showAdminTab(tabName) {
            document.getElementById('adminUsers').style.display = 'none';
            document.getElementById('adminPayments').style.display = 'none';
            document.getElementById('adminStats').style.display = 'none';
            
            document.getElementById('admin' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).style.display = 'block';
            
            const btns = document.querySelectorAll('#adminPanelModal .tab-btn');
            btns.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        async function loadAllUsers() {
            try {
                const snapshot = await db.collection('users').get();
                allUsers = [];
                snapshot.forEach(doc => {
                    allUsers.push({ id: doc.id, ...doc.data() });
                });
                displayUsers(allUsers);
            } catch (error) {
                console.error('Error loading users:', error);
            }
        }

        function displayUsers(users) {
            const usersList = document.getElementById('usersList');
            if (users.length === 0) {
                usersList.innerHTML = '<div class="user-item">No users found</div>';
                return;
            }
            
            usersList.innerHTML = users.map(user => `
                <div class="user-item">
                    <div class="user-info-detail">
                        <strong>${user.username || 'No username'}</strong><br>
                        <small>${user.email}</small><br>
                        <span class="badge ${user.isPremium ? 'badge-premium' : 'badge-free'}">
                            ${user.isPremium ? 'PREMIUM' : 'FREE'}
                        </span>
                    </div>
                    <div class="user-actions">
                        ${user.isPremium ? 
                            `<button class="btn-small btn-remove" onclick="removePremium('${user.id}', '${user.username}')">Remove Premium</button>` :
                            `<button class="btn-small btn-activate" onclick="activatePremium('${user.id}', '${user.username}')">Activate Premium</button>`
                        }
                    </div>
                </div>
            `).join('');
        }

        function filterUsers() {
            const searchTerm = document.getElementById('userSearch').value.toLowerCase();
            const filtered = allUsers.filter(user => 
                (user.username || '').toLowerCase().includes(searchTerm) ||
                (user.email || '').toLowerCase().includes(searchTerm)
            );
            displayUsers(filtered);
        }

        async function activatePremium(userId, username) {
            if (confirm(`Activate premium for ${username}?`)) {
                try {
                    await db.collection('users').doc(userId).update({
                        isPremium: true,
                        premiumActivatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    alert('Premium activated successfully!');
                    await loadAllUsers();
                    updateAdminStats();
                } catch (error) {
                    alert('Error: ' + error.message);
                }
            }
        }

        async function removePremium(userId, username) {
            if (confirm(`Remove premium from ${username}?`)) {
                try {
                    await db.collection('users').doc(userId).update({
                        isPremium: false
                    });
                    alert('Premium removed successfully!');
                    await loadAllUsers();
                    updateAdminStats();
                } catch (error) {
                    alert('Error: ' + error.message);
                }
            }
        }

        async function loadPaymentRequests() {
            try {
                const snapshot = await db.collection('paymentRequests').orderBy('submittedAt', 'desc').get();
                allPayments = [];
                snapshot.forEach(doc => {
                    allPayments.push({ id: doc.id, ...doc.data() });
                });
                displayPayments(allPayments);
            } catch (error) {
                console.error('Error loading payments:', error);
            }
        }

        function displayPayments(payments) {
            const paymentsList = document.getElementById('paymentsList');
            if (payments.length === 0) {
                paymentsList.innerHTML = '<div class="user-item">No payment requests</div>';
                return;
            }
            
            paymentsList.innerHTML = payments.map(payment => `
                <div class="user-item">
                    <div class="user-info-detail">
                        <strong>${payment.username}</strong><br>
                        <small>${payment.email}</small><br>
                        <small>Amount: ‚Ç¶${payment.amount}</small><br>
                        <span class="badge ${payment.status === 'pending' ? 'badge-free' : 'badge-premium'}">
                            ${payment.status.toUpperCase()}
                        </span>
                    </div>
                    <div class="user-actions">
                        ${payment.status === 'pending' ? 
                            `<button class="btn-small btn-activate" onclick="approvePayment('${payment.id}', '${payment.userId}', '${payment.username}')">Approve</button>
                             <button class="btn-small btn-remove" onclick="rejectPayment('${payment.id}')">Reject</button>` :
                            `<small>${payment.status}</small>`
                        }
                    </div>
                </div>
            `).join('');
        }

        async function approvePayment(paymentId, userId, username) {
            if (confirm(`Approve payment and activate premium for ${username}?`)) {
                try {
                    await db.collection('paymentRequests').doc(paymentId).update({
                        status: 'approved',
                        approvedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    await db.collection('users').doc(userId).update({
                        isPremium: true,
                        premiumActivatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    alert('Payment approved and premium activated!');
                    await loadPaymentRequests();
                    await loadAllUsers();
                    updateAdminStats();
                } catch (error) {
                    alert('Error: ' + error.message);
                }
            }
        }

        async function rejectPayment(paymentId) {
            if (confirm('Reject this payment request?')) {
                try {
                    await db.collection('paymentRequests').doc(paymentId).update({
                        status: 'rejected',
                        rejectedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    alert('Payment rejected');
                    await loadPaymentRequests();
                    updateAdminStats();
                } catch (error) {
                    alert('Error: ' + error.message);
                }
            }
        }

        function updateAdminStats() {
            const totalUsers = allUsers.length;
            const premiumUsers = allUsers.filter(u => u.isPremium).length;
            const pendingPayments = allPayments.filter(p => p.status === 'pending').length;
            
            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('premiumUsers').textContent = premiumUsers;
            document.getElementById('pendingPayments').textContent = pendingPayments;
        }

        // Clear cache when user logs out
        auth.onAuthStateChanged((user) => {
            if (!user) {
                cache.data = {};
                cache.timestamps = {};
            }
        });
    </script>
</body>
</html>
